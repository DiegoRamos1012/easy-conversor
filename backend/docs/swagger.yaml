openapi: 3.0.0

info:
  title: EasyConversor API
  version: 1.1.0
  description: |
    API para conversão de arquivos de imagem. Suporta entrada em JPG, PNG, WEBP,
    GIF e AVIF, permitindo conversão para PNG, JPG/JPEG, WEBP, GIF, AVIF ou PDF.

servers:
  - url: http://localhost:4000
    description: Servidor de desenvolvimento local

tags:
  - name: Conversão
    description: Endpoints relacionados à conversão de arquivos

paths:
  /convert:
    post:
      summary: Converte um arquivo de imagem para outro formato
      description: |
        Envie um arquivo de imagem para convertê-lo para PNG, JPG/JPEG, WEBP, GIF, AVIF ou PDF.
        Formatos de entrada aceitos: JPG, JPEG, PNG, WEBP, GIF, AVIF.
      tags:
        - Conversão

      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: Arquivo de imagem enviado
                type:
                  type: string
                  description: Formato desejado de saída
                  enum: [png, jpg, jpeg, webp, gif, avif, pdf]
              required:
                - file
                - type
            examples:
              exemploUpload:
                summary: Envio de um arquivo PNG para conversão em AVIF
                value:
                  type: "avif"

      responses:
        "200":
          description: Conversão realizada com sucesso
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ConvertedFileResponse"
              examples:
                conversaoOk:
                  summary: Exemplo de resposta de sucesso
                  value:
                    message: "Arquivo convertido com sucesso"
                    outputFile: "temp/abc123.avif"

        "400":
          description: Erro na solicitação ou formato inválido
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                erroEntrada:
                  summary: Tipo de arquivo inválido
                  value:
                    error: "Formato de saída inválido. Permitidos: png, jpg, jpeg, webp, gif, avif, pdf."

        "500":
          description: Erro interno no servidor
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                erroInterno:
                  summary: Falha inesperada
                  value:
                    error: "Falha ao converter o arquivo."

components:
  schemas:
    ConvertedFileResponse:
      type: object
      description: Resposta retornada após conversão bem-sucedida.
      properties:
        message:
          type: string
          example: Arquivo convertido com sucesso
        outputFile:
          type: string
          description: Caminho do arquivo final
          example: temp/arquivo-final.webp

    ErrorResponse:
      type: object
      description: Estrutura padrão para erros.
      properties:
        error:
          type: string
          example: O arquivo enviado não é uma imagem válida.
